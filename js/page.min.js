$(function(){var a,b;gwFuns.initFun(),setTimeout(function(){new nie.util.pageLoad({imgSelector:"img"})},0),a=["ui.tab","util.share","nie.util.share","ui.Switch","nie.util.freshNews","util.bjTime"],nie.use(a,function(){var a=nie.util.freshNews();console.log(a.data.length),$.Switch({btnDoms:[$(".picSwitchBtn")],imgDoms:[$(".picList")],conDoms:[$(".tukuM li span")]}),$.share.appendTo("#share"),$.tab("#fTabNav1 li","#fTabCont1 .ftxtList"),$.tab("#fTabNav2 li","#fTabCont2 .ftxtList"),$.bjTime.getDate(gwFuns.calTime)}),b=$(window),$.browser.msie&&"6.0"==$.browser.version&&$(window).scroll(function(){var a=$("#pcWrap"),c=a.outerHeight(),d=b.scrollTop(),e=b.height();c>=e||(em.css({position:"absolute"}),a.stop().animate({top:d+(e-c-20)},time||400))}),document.getElementById("searchResult").onclick=function(){gwFuns.search()},$(".entryBlock h3").click(function(){$(".entryBlockWrap").fadeIn()}),$("#entryClose").click(function(){$(".entryBlockWrap").fadeOut()})});var gwFuns={lunboInit:function(){var a=$("#bannerShowItem"),b=$("#bannerShowImg");b.find("li").eq(0).show(),a.find("a").eq(0).addClass("current"),$("#bannerShow").initLunbo()},search:function(){var a=$("#searchKeyWords1").val();window.open(encodeURI("http://so.xy2.163.com/search?qs="+a))},switchSmart:function(){function a(a){for(g;a>g;g++,h++)c.eq(h).attr("data-images",d.eq(g).data("images")).attr("data-href",d.eq(g).data("href")).attr("data-title",d.eq(g).data("title"));c.each(function(a){var b=$(this),c=b.find("img:first"),d=$(this).attr("data-images"),e=$(this).attr("data-href"),f=$(this).attr("data-title");b.find(".imgWrap").append('<img src="'+d+'" alt="'+f+'" width="230" height="250" class="flipInX"/>'),b.find(".introBg").find("p").text(f),b.find("a").attr("href",e+"?from=banner"+a),setTimeout(function(){c.remove()},2e3)}),h=0}var b=$("#secSwitch"),c=$("#switchWrap li"),d=b.find(".imgdata"),e=d.length-1,f=null,g=0,h=0;a(3),c.hover(function(){$(this).find(".numShow").toggleClass("numShowCurrent"),$(this).find(".introDetail").toggleClass("introDetailCurrent")}),f=setInterval(function(){if(e>g){var b=g+3;a(b)}else g=0},5e3),b.mouseenter(function(){clearInterval(f)}),b.mouseleave(function(){clearInterval(f),f=setInterval(function(){if(e>g){var b=g+3;a(b)}else g=0},5e3)})},scrollPics:function(a){var b,c,d,e,f,g,h,i,j,k,l={currentTarget:"",wrap:"",autoplay:!0,minNum:1,time:5e3,tab:""};a=a||{},l=$.extend(l,a),b=$(l.currentTarget),c=$(l.wrap),d=c.find("ul"),e=d.find("li").length,f=d.find("li").width(),g=b.find(".prev"),h=b.find(".next"),i=$(l.tab),j=null,k=0,d.css("width",f*e),e>l.minNum&&(h.click(function(){k++,k==e&&(k=0),i.removeClass("current").eq(k).addClass("current"),d.stop().animate({left:-(f*k)},300)}),g.click(function(){k--,0>k&&(k=e-1),i.removeClass("current").eq(k).addClass("current"),d.stop().animate({left:-(f*k)},300)}),l.autoplay&&(j=setInterval(function(){h.trigger("click")},l.time),c.mouseenter(function(){clearInterval(j)}),c.mouseleave(function(){clearInterval(j),j=setInterval(function(){h.trigger("click")},l.time)})))},entryDetail:function(){$(".slideTopDetail").hover(function(){var a=$(this).index();$(".entryItem").addClass("hide").eq(a).removeClass("hide"),$(".entryWrap").addClass("entryWrapShow"),$(".slideTopDetail").removeClass("current"),$(this).delay(100).addClass("current")}),$("#closeWrap").click(function(){$(".slideTopDetail").removeClass("current"),$(".entryWrap").removeClass("entryWrapShow")})},openD:function(a){function b(a){a.height()>m?a.fadeIn().css({top:o,left:(n-a.outerWidth())/2+p}):a.fadeIn().css({top:(m-a.outerHeight())/2+o,left:(n-a.outerWidth())/2+p})}var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r={id:"",type:"",width:"",height:"",flashurl:"",videourl:"",wmode:"",startImg:""};switch(a=a||{},r=$.extend(r,a),c=$("#NIE-overlayer"),d=$(r.id),e=r.type,f=parseInt(r.width),g=parseInt(r.height),h=r.startImg,i=r.flashurl,j=r.videourl,k=r.wmode,l=$(document).height(),m=$(window).height(),n=$(window).width(),o=$(window).scrollTop(),p=$(window).scrollLeft(),c.css({height:l}).show(),$(".aCloseQ").click(function(){$(this).parent().fadeOut(),$("#NIE-overlayer").hide()}),e){case"1":b(d);break;case"2":$("#flash-wrap").html(""),nie.use(["util.swfobject"],function(){$("#flash-wrap").flash({swf:i,width:f,height:g,allowScriptAccess:"always",wmode:k})}),q=$("#flashtc1"),q.css({width:f,height:g}),$(".aCloseQ").hide(),b(d);break;case"3":$("#dVideo").html("").css({height:g+"px",width:f+"px"}),d.css({height:g+22+"px",width:f+22+"px"}),b(d),nie.use(["nie.util.video"],function(){nie.util.video($("#dVideo"),{movieUrl:j,mp4_movieUrl:j.replace(/\.(flv|f4v)/,".mp4"),width:f,height:g,startImg:h,bufferTime:5,loopTimes:0,wmode:"opaque",volume:.8,autoPlay:!0})})}},fightTeam:function(){$.ajax({type:"get",url:"http://xy2-pk.webapp.163.com/user/get_champ_team",dataType:"jsonp",success:function(a){var b,c;c=a.max_seq,b=a.champ_team[0].server_name,$("#fightTeam").html("第<em>"+c+"</em>届比武大会冠军服务器：<strong>"+b+"</strong>")}})},calTime:function(a){var b,c,d,e=["一","二","三","四","五","六","日"],f=864e5,g=new Date(a.dateObj);switch(a.day){case 0:b="日";break;case 1:b="一";break;case 2:b="二";break;case 3:b="三";break;case 4:b="四";break;case 5:b="五";break;case 6:b="六"}0==a.day?(c=new Date(g.getTime()-6*f),d=6):(c=new Date(g.getTime()-f*(a.day-1)),d=a.day-1),$(".calTime").each(function(a){var b=new Date(c.getTime()+f*a),d="<strong>时间：</strong>";d+=b.getMonth()+1+"月"+b.getDate()+"日"+"　周"+e[a],$(this).html(d)})},initFun:function(){gwFuns.lunboInit(),gwFuns.switchSmart(),gwFuns.entryDetail(),gwFuns.fightTeam(),gwFuns.scrollPics({currentTarget:"#slideShow",wrap:"#slideWrap"}),gwFuns.scrollPics({currentTarget:"#slideShow2",wrap:"#slideWrap2",autoplay:!1})}};nie.util.pageLoad=nie.util.pageLoad||function(a){$(function(){var b=$(window),c={},d={},e=window.location.hash,f=function(){var a,e,f,g=b.scrollTop()-50,h=g+b.height()+50;for(a in c)e=c[a],f=!1,e.b?(e.y>=g&&e.y<=h||e.b>=g&&e.b<=h)&&(f=!0):e.y>=g&&e.y<=h&&(f=!0),f&&e.dom.attr("src",e.src);for(a in d)e=d[a],(e.top>=g&&e.top<=h||e.bot>=g&&e.bot<=h)&&e.dom.attr("style","background-image:url("+e.src+")")};a.bgSelector&&$(a.bgSelector).each(function(a){var b,c=$(this),e=c.attr("data-bgUrl");""!=e&&(b=c.offset().top+parseInt($.browser.msie?c.css("background-position-y"):c.css("background-position").split(" ")[1]),d[a]={dom:c,src:e,top:b,bot:b+c.height()})}),a.imgSelector&&$(a.imgSelector).each(function(a){var b=$(this),d=b.attr("data-src");""!=d&&(c[a]={dom:b,src:d,y:b.offset().top},b.css("height")?c[a].b=c[a].y+parseInt(b.css("height")):b.attr("height")&&(c[a].b=c[a].y+parseInt(b.attr("height"))))}),b.scroll(f).resize(f),(""==e||0==$("a#"+e+"[name="+e+"]").length)&&f()})},$.fn.initLunbo=function(a){function b(){var a=$(window).width();f.width(240*g.length),1104>=a?p.css("width","1104px"):p.css("width","100%")}function c(){k=k>=h-1?0:k+1,m=k-2,m>=0&&h-4>=m&&(l=m*o.oWidth),0>=k&&(l=0),k==h-1&&(l=(h-4)*o.oWidth),d(),e()}function d(){f.stop().animate({left:-l+"px"})}function e(){g.removeClass("current").eq(k).addClass("current"),q.stop().hide().eq(k).show().css("opacity","0.5").animate({opacity:"1.0"},o.time),$("#moreBtn").attr("href",q.eq(k).find("a").attr("data-href"))}var f,g,h,i,j,k,l,m,n={lunbo_box:"#bannerShow",lunbo_item:".lunboImgItem",lunbo_nav_btn:"#bannerShowItem ul",lunbo_nav:".lunboNav",lunbo_prev:"#lunboPrev",lunbo_next:"#lunboNext",time:1e3,time2:6e3,oWidth:240,timer:null},o=$.extend(n,a),p=$(this),q=p.find(o.lunbo_item);$(this).find(o.lunbo_nav),f=$(this).find(o.lunbo_nav_btn),g=f.find("a"),h=g.length,i=$(o.lunbo_prev),j=$(o.lunbo_next),k=0,l=0,m=0,g.each(function(a){$(this).hover(function(){k=a,d(),e()},function(){})}),i.click(function(){k=0>=k?h-1:k-1,m=k-2,m>=0&&h-4>=m&&(l=m*o.oWidth),k>=6&&(l=(h-4)*o.oWidth),2>=k&&(l=0),d(),e()}),j.click(function(){c()}),b(),$("#moreBtn").attr("href",q.eq(0).find("a").attr("data-href")),o.timer=setInterval(c,o.time2),$(this).hover(function(){clearInterval(o.timer),o.timer=null},function(){o.timer=setInterval(c,o.time2)}),$(window).resize(function(){b()})};